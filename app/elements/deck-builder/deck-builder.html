<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-menu/core-menu.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/core-icons/image-icons.html">
<link rel="import" href="../../bower_components/core-menu/core-submenu.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../../bower_components/core-scaffold/core-scaffold.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">

<link rel="import" href="../image-uploader/image-uploader.html">
<link rel="import" href="../data-storage/data-storage.html">
<link rel="import" href="../deck-sorter/deck-sorter.html">


<polymer-element
    name="deck-builder">
  <template>
    <link rel="stylesheet" href="deck-builder.sass">

    <data-storage id="dataStorage"></data-storage>

    <core-scaffold>
      <core-header-panel navigation flex mode="seamed">
        <core-toolbar>Decks</core-toolbar>
        <core-menu id="deckMenu" theme="core-light-theme">
          <template repeat="{{ deck in decks }}">
            <div horizontal layout>
              <paper-item
                  data-guid="{{deck.guid}}"
                  on-tap="{{loadDeck}}"
                  flex>
                <core-icon icon="image:crop-portrait"></core-icon>
                {{deck.name}}
              </paper-item>
              <paper-icon-button
                  class="deckDeleteButton"
                  data-guid="{{deck.guid}}"
                  on-tap="{{deleteDeck}}"
                  icon="delete">
              </paper-icon-button>
            </div>
          </template>
          <paper-item on-tap="{{addNewDeck}}">
            <core-icon icon="add-circle"></core-icon>
            Add New Deck
          </paper-item>
        </core-menu>
      </core-header-panel>
      <div tool><paper-input id="deckNameInput" value="{{currentDeck.name}}" on-keydown="{{deckNameOnInput}}" on-blur="{{deckNameOnBlur}}"></paper-input></div>
      <div id="deckParentWindow" vertical layout fit>

        <deck-sorter
            id="deckSorter"
            on-layout-complete="{{updateCurrentDeckFromSorter}}"
            on-checkbox-changed="{{cardCheckboxChanged}}"
            flex>
        </deck-sorter>

        <div class="lowerActions" horizontal layout end>
          <div flex>
            <paper-button
                id="deleteCardsButton"
                disabled
                on-tap="{{deleteSelectedCards}}">
              <core-icon icon="delete"></core-icon>
              Delete
            </paper-button>
            <paper-button
                id="copyCardsButton"
                disabled
                on-tap="{{copySelectedCards}}">
              <core-icon icon="content-copy"></core-icon>
              Copy To...
            </paper-button>
            <paper-button
                id="moveCardsButton"
                disabled
                on-tap="{{moveSelectedCards}}">
              <core-icon icon="folder-open"></core-icon>
              Move To...
            </paper-button>
          </div>
          <image-uploader id="imageUploader" on-new-image="{{newImageAdded}}"></image-uploader>
        </div>

      </div>
    </core-scaffold>

  </template>
  <!-- build:js deck-builder.js -->
  <script src="deck-builder.coffee"></script>
  <!-- endbuild -->
</polymer-element>
