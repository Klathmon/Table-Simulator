<link rel="import" href="../builder-card/builder-card.html">
<link rel="import" href="../image-uploader/image-uploader.html">
<link rel="import" href="../data-storage/data-storage.html">
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/font-roboto/roboto.html">
<link rel="import" href="../../bower_components/core-menu/core-menu.html">
<link rel="import" href="../../bower_components/core-item/core-item.html">
<link rel="import" href="../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../bower_components/core-input/core-input.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/core-menu/core-submenu.html">
<link rel="import" href="../../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-splitter/core-splitter.html">
<link rel="import" href="../../bower_components/core-scaffold/core-scaffold.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">


<polymer-element name="deck-builder" on-new-image="{{newImageUploaded}}">
  <template>
    <link rel="stylesheet" href="deck-builder.sass">

    <data-storage
        id="dataStorage"
        on-card-added={{cardAddedToDeck}}
        on-deck-added={{deckAdded}}
        on-deck-renamed={{loadDeckList}}>
    </data-storage>

    <paper-shadow z="5"></paper-shadow>

    <core-scaffold id="scaffold" responsiveWidth="2000px">
      <core-header-panel navigation flex mode="seamed">
        <core-toolbar>Decks:</core-toolbar>
        <core-menu
            theme="core-light-theme"
            valueattr="label"
            selected="{{selectedDeck}}"
            on-core-activate="{{menuItemSelected}}">

          <template class="window" id="deckList" repeat="{{ deckName in decks }}">
            <paper-item
                icon="content-copy"
                label="{{deckName}}"
                on-tap="{{selectDeck}}">
            </paper-item>
          </template>

          <paper-item
              icon="add-circle"
              label="Add New Deck"
              on-tap="{{addNewDeck}}">
          </paper-item>

        </core-menu>
      </core-header-panel>

      <div tool horizontal layout>
        <div flex>Deck Builder</div>
      </div>

      <div id="mainWindow" on-drag-end="{{cardDropped}}" fit horizontal layout>
        <div id="deckSplitterWindow" class="splitterWindow hideMe" vertical layout>

          <div>
            <paper-input
                id="deckName"
                type="text"
                value="{{deckName}}">
            </paper-input>
          </div>

          <div
              flex
              class="window"
              id="deckWindow">
          </div>

          <div class="lowerActions" horizontal layout end>
            <paper-fab class="deleteButton" icon="delete" mini></paper-fab>
          </div>

        </div>
        <core-splitter
            id="splitter"
            class="hideMe"
            on-mouseup="{{splitterMouseUp}}"
            on-touchend="{{splitterMouseUp}}"
            direction="left">
        </core-splitter>
        <div class="splitterWindow" flex vertical layout>

          <div>
            <h2>My Collection</h2>
          </div>

          <div class="window" id="collectionWindow" flex></div>

          <div class="lowerActions" horizontal layout end>
            <div flex>
              <paper-fab
                  class="deleteButton"
                  icon="delete"
                  mini
                  on-tap="{{deleteCollection}}">
              </paper-fab>
            </div>
            <image-uploader></image-uploader>
          </div>

        </div>
      </div>
    </core-scaffold>

  </template>
  <!-- build:js deck-builder.js -->
  <script src="../../bower_components/packery/dist/packery.pkgd.js"></script>
  <script src="../../bower_components/localforage/dist/localforage.js"></script>
  <script src="deck-builder.coffee"></script>
  <!-- endbuild -->
</polymer-element>
